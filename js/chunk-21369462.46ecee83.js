(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-21369462"],{"1f0b":function(t,e,s){"use strict";var a=s("3129"),i={name:"BookListMobileSkeleton"},o=(s("f412"),s("2877")),r=Object(o.a)(i,(function(){var t=this._self._c;return t("div",[t("ul",[t("li",[t("section",{staticClass:"skeleton-book-list"},[t("div",{staticClass:"img"},[t(a.a,{attrs:{type:"list-item-avatar-two-line"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}})],1)])]),t("li",[t("section",{staticClass:"skeleton-book-list"},[t("div",{staticClass:"img"},[t(a.a,{attrs:{type:"list-item-avatar-two-line"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}})],1)])]),t("li",[t("section",{staticClass:"skeleton-book-list"},[t("div",{staticClass:"img"},[t(a.a,{attrs:{type:"list-item-avatar-two-line"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}})],1)])]),t("li",[t("section",{staticClass:"skeleton-book-list"},[t("div",{staticClass:"img"},[t(a.a,{attrs:{type:"list-item-avatar-two-line"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}})],1)])]),t("li",[t("section",{staticClass:"skeleton-book-list"},[t("div",{staticClass:"img"},[t(a.a,{attrs:{type:"list-item-avatar-two-line"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}})],1)])])])])}),[],!1,null,"975c769e",null);e.a=r.exports},"2edc":function(t,e,s){},3443:function(t,e,s){"use strict";s("f53c")},4809:function(t,e,s){},"68e0":function(t,e,s){"use strict";s.d(e,"a",(function(){return a}));const a=function(t,e,s,a){return{name:t,width:e,height:s,resizable:a,clickToClose:!1,draggable:".popup-title",scrollable:!0}}},"691b":function(t,e,s){"use strict";var a=s("3129"),i={name:"BookListSkeleton"},o=(s("b57b"),s("2877")),r=Object(o.a)(i,(function(){var t=this._self._c;return t("div",[t("ul",[t("li",[t("section",{staticClass:"d-flex align-center justify-space-between skeleton-book-list"},[t("div",{staticClass:"img"},[t(a.a,{attrs:{type:"list-item-avatar-two-line"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1)])]),t("li",[t("section",{staticClass:"d-flex align-center justify-space-between skeleton-book-list"},[t("div",{staticClass:"img"},[t(a.a,{attrs:{type:"list-item-avatar-two-line"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1)])]),t("li",[t("section",{staticClass:"d-flex align-center justify-space-between skeleton-book-list"},[t("div",{staticClass:"img"},[t(a.a,{attrs:{type:"list-item-avatar-two-line"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1)])]),t("li",[t("section",{staticClass:"d-flex align-center justify-space-between skeleton-book-list"},[t("div",{staticClass:"img"},[t(a.a,{attrs:{type:"list-item-avatar-two-line"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1)])]),t("li",[t("section",{staticClass:"d-flex align-center justify-space-between skeleton-book-list"},[t("div",{staticClass:"img"},[t(a.a,{attrs:{type:"list-item-avatar-two-line"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1)])])])])}),[],!1,null,"d8eeb990",null);e.a=r.exports},"694a":function(t,e,s){},7402:function(t,e,s){"use strict";var a=s("132d"),i={methods:{close(){this.$emit("close")}}},o=(s("cc0a"),s("2877")),r=Object(o.a)(i,(function(){var t=this._self._c;return t("div",{staticClass:"modal-wrap"},[t("div",{staticClass:"close",on:{click:this.close}},[t(a.a,[this._v("mdi-window-close")])],1),this._t("head"),t("div",{staticClass:"line"}),t("div",{staticClass:"body"},[this._t("body")],2),this._t("footer")],2)}),[],!1,null,"1c84da6b",null);e.a=r.exports},"84ac":function(t,e,s){"use strict";s.r(e);var a=s("ac7c"),i=(s("14d9"),s("2f62")),o=s("f3e4"),r=s("e71f"),l=s("e31c"),c=s("691b"),d=s("1f0b"),n=(s("b7ef"),s("bc3a"));const u="https://api.instapay.kr",p="n20fz-id19l-02n18-15o48-r59gl";function h(){return!/MID|TB-8504F|SM-T580|Nexus 9|P20HD|SM-P555S|SM-T536|SM-T385K|SM-T530|LG-V607L|MPGIO-10|muPAD/i.test(navigator.userAgent)&&(/(?=.*Android)(?=.*Mobile Safari).*/i.test(navigator.userAgent)||/iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))}function _(){const t=navigator.userAgent.toLowerCase();return-1!=t.indexOf("msie")&&parseInt(t.split("msie")[1])}var v={data:()=>({nPay:{goods:"",ttl:20,price:""},qr:"",result:"",ti:"",re:"",res:{createdQrcode:!1,paid:!1}}),methods:{_open(t){_()&&_()<10?alert("internet explorer 10 이상 지원합니다."):void 0===this.qr||this.nPay.goods!==t.productName||this.nPay.price!==t.productAmount||this.nPay.ttl!==t.ttl?(this.nPay.goods=t.productName,this.nPay.price=1,this.nPay.ttl=t.ttl,this._createQrcode()):this._createWait()},_createQrcode(){const t=`goods=${encodeURIComponent(btoa(unescape(encodeURIComponent(this.nPay.goods))))}&price=${this.nPay.price}&ttl=${this.nPay.ttl}&ldate=nil`;var e;(e=t,n.a.get(`${u}/s2/sell?${e}`,{headers:{Authorization:"Bearer "+p}})).then(t=>{4===t.request.readyState&&200===t.request.status&&this._resultQrcode(t.request.responseText)}).catch(t=>{console.log(t)})},_resultQrcode(t){const e=JSON.parse(t);"ok"===e.result?this._create(e.gid):this.result=this.res},_create(t){var e;(e=t,n.a.get(`${u}/s2/buy?i=${e}`,{headers:{Authorization:"Bearer "+p}})).then(t=>{4===t.request.readyState&&200===t.request.status&&this._result(t.request.responseText)}).catch(t=>{console.log(t)})},_result(t){const e=JSON.parse(t);"ok"===e.result?(this.qr=e.qr,this.ti=e.ti,this.re=e.re,this.res.createdQrcode=!0,h()?(location.href=this.re,this._createWait()):this._createWait()):this.result=this.res},_createWait(){var t;(t=this.ti,n.a.get(`${u}/s2/wait?ti=${t}`)).then(t=>{4===t.request.readyState&&200===t.request.status&&this._resultWait(t.request.responseText)}).catch(t=>{console.log(t)})},_waitComplete(){var t;(t=this.ti,n.a.get(`${u}/s2/wait?ti=${t}&st=complete`)).then(t=>{4===t.request.readyState&&200===t.request.status&&this._resultWait(t.request.responseText)}).catch(t=>{console.log(t)})},_resultWait(t){const e=JSON.parse(t);"ok"===e.result?"entry"===e.tstatus?(h()&&alert("결제가 진행중 입니다. 창을 닫거나, 새로고침 하시면 오류가 발생할 수 있습니다."),this._waitComplete()):(this.res.paid=!0,this.result=this.res):this.result=this.res},_stop(){window.stop()}}},b={name:"Order",components:{modalWrap:s("7402").a},mixins:[v],props:["book","price"],watch:{"res.paid":function(t){t&&(this.$attrs.update(),this.$emit("close"))}},mounted(){this._open({productName:this.book.join(","),productAmount:this.price,ttl:20})},methods:{close(){this.$attrs.close(),this.$emit("close")}}},m=(s("ee6b"),s("2877")),y=Object(m.a)(b,(function(){var t=this,e=t._self._c;return e("modalWrap",{on:{close:t.close}},[e("template",{slot:"head"},[e("h2",[t._v("발주(결제)")])]),e("template",{slot:"body"},[e("section",{staticClass:"info"},[e("h3",[t._v("\n        "+t._s(t.book[0])+" "),t.book.length>1?e("span",[t._v("외 "+t._s(t.book.length-1)+"권")]):t._e()]),e("p",{staticClass:"price"},[t._v(t._s(t.price.toLocaleString())+"원")]),e("div",{staticClass:"qr-wrap"},[e("div",{staticClass:"center"},[e("img",{attrs:{src:t.qr,alt:""}})]),e("div",{staticClass:"pay"},[t._v("인스타페이 앱으로 결제해 주세요")])])])])],2)}),[],!1,null,"a9e2144c",null).exports,k=s("68e0"),f={components:{BookListMobileSkeleton:d.a,BookListSkeleton:c.a},mixins:[v],props:["id","orderTimeId"],data:()=>({books:[],selected:[],selectedAll:!1,allID:[],checkCount:0,checkPrice:0,buyList:[],buyId:[],uid:""}),computed:{...Object(i.b)("common",["windowWidth","mobile","skeletonLoading"]),bookCount(){if(0===this.books[0].data.shop_order_status){let t=0;return this.books.forEach(e=>t+=Number(e.data.count)),t}return 0},totalPrice(){let t=0;return this.books.forEach(e=>{var s;if(""!==e.data.shop_rate&&(null===(s=e.data.shop_rate)||void 0===s?void 0:s.length)>0){if(e.data.shop_rate.some(t=>t.uid===this.uid)){let s="";e.data.shop_rate.forEach(t=>{t.uid===this.uid&&(s=t.rate)}),t+=e.data.price*Number(s)*e.data.count/100}}else t+=e.data.price*e.data.supply_rate*e.data.count/100}),t}},watch:{selected(){1===this.books[0].data.shop_order_status&&(this.checkCount=0,this.checkPrice=0,this.books.forEach(t=>{var e;if(this.selected.includes(t.id))if(this.checkCount+=t.data.reply_count,""!==t.data.shop_rate&&(null===(e=t.data.shop_rate)||void 0===e?void 0:e.length)>0){if(t.data.shop_rate.some(t=>t.uid===this.uid)){let e="";t.data.shop_rate.forEach(t=>{t.uid===this.uid&&(e=t.rate)}),this.checkPrice+=t.data.price*e*t.data.reply_count/100}}else this.checkPrice+=t.data.price*t.data.supply_rate*t.data.reply_count/100})),this.allID.length===this.selected.length?this.selectedAll=!0:this.selectedAll=!1},selectedAll(t){t?this.selected=this.allID:this.allID.length===this.selected.length&&(this.selected=[])}},created(){this.load()},mounted(){const{uid:t}=Object(o.b)("userInfo");this.uid=t},methods:{async load(){try{this.books=[],this.allID=[],this.$store.commit("common/setSkeleton",!0);const{uid:t}=Object(o.b)("userInfo"),e=Object(r.j)(Object(r.b)(l.b,"orderRequest"),Object(r.o)("uid","==",t),Object(r.o)("sid","==",Number(this.id)),Object(r.o)("order_time_id","==",this.orderTimeId));(await Object(r.f)(e)).forEach(t=>{this.books.push({id:t.id,data:t.data()}),0!==t.data().reply_count&&this.allID.push(t.id)})}catch(t){console.log(t)}this.$store.commit("common/setSkeleton",!1)},async order(){0!==this.checkCount?(this.buyList=[],this.buyId=[],this.books.forEach(t=>{this.selected.includes(t.id)&&(this.buyList.push(t.data.subject),this.buyId.push(t.id))}),h()?this._open({productName:this.buyList.join(","),productAmount:this.checkPrice,ttl:20}):this.$modal.show(y,{book:this.buyList,price:this.checkPrice,update:this.paidComplete,close:this._stop},Object(k.a)("ModalOrder","500px","auto",!1))):alert("책을 선택해 주세요")},async paidComplete(){const t=Object(r.p)(l.b);try{const e=Object(r.k)();await this.books.forEach(s=>{const a=Object(r.d)(l.b,"orderRequest",s.id);t.update(a,{shop_order_status:3,order_real_time_id:this.$date().format("YYYYMMDDHHmmss"),order_real_time:e,totalPrice:this.checkPrice,totalCount:this.checkCount})}),await this.buyId.forEach(e=>{const s=Object(r.d)(l.b,"orderRequest",e);t.update(s,{order_check:!0})}),await t.commit(),await this.load()}catch(t){console.log(t)}}}},x=(s("3443"),{name:"OrderResult",components:{OrderResultList:Object(m.a)(f,(function(){var t,e,s,i,o,r,l=this,c=l._self._c;return c("section",[!l.mobile&&l.skeletonLoading?c("BookListSkeleton"):l._e(),l.mobile&&l.skeletonLoading?c("BookListMobileSkeleton"):l._e(),l.mobile||l.skeletonLoading?l._e():c("section",{staticClass:"header d-flex"},[c("div",{staticClass:"d-flex dual"},[c("div",[(null===(t=l.books[0])||void 0===t?void 0:t.data.shop_order_status)<3?c(a.a,{attrs:{disabled:1!==(null===(e=l.books[0])||void 0===e?void 0:e.data.shop_order_status)},model:{value:l.selectedAll,callback:function(t){l.selectedAll=t},expression:"selectedAll"}}):l._e()],1),c("div",[l._v("품목정보")])]),c("div",[l._v("ISBN")]),l._m(0),c("div",[l._v("공급가")]),c("div",[l._v("주문")]),c("div",[l._v("공급")])]),c("ul",{staticClass:"body"},l._l(l.books,(function(t,e){var s,i,o,r,d,n,u;return c("li",{key:e,staticClass:"d-flex align-center",class:{none:t.data.shop_order_status>2&&!1===t.data.order_check}},[c("div",{staticClass:"d-flex align-center info-wrap ck-wrap"},[c("div",{staticClass:"ck-box"},[3===(null===(s=l.books[0])||void 0===s?void 0:s.data.shop_order_status)?c(a.a,{attrs:{"input-value":t.data.order_check,disabled:""}}):c(a.a,{attrs:{value:t.id,disabled:1!==(null===(i=l.books[0])||void 0===i?void 0:i.data.shop_order_status)||0===t.data.reply_count},model:{value:l.selected,callback:function(t){l.selected=t},expression:"selected"}})],1),c("div",{staticClass:"book-info"},[c("h3",[l._v(l._s(t.data.subject))]),c("div",{staticClass:"author"},[l._v(l._s(t.data.author))])])]),c("div",{staticClass:"isbn"},[l._v(l._s(t.data.isbn))]),c("div",{staticClass:"d-flex price-info"},[c("div",{staticClass:"normal-price"},[l.mobile?c("span",[l._v("정가")]):l._e(),l._v(" "+l._s(null===(o=t.data.price)||void 0===o?void 0:o.toLocaleString()))]),(null===(r=t.data.shop_rate)||void 0===r?void 0:r.length)>0&&t.data.shop_rate.some(t=>t.uid===l.uid)?c("div",l._l(t.data.shop_rate,(function(t){return c("span",{key:t.uid},[l.uid===t.uid?c("span",[l.mobile?c("span",[l._v("공급률")]):l._e(),l._v(" "+l._s(t.rate)+"%")]):l._e()])})),0):l._e(),0===(null===(d=t.data.shop_rate)||void 0===d?void 0:d.length)||(null===(n=t.data.shop_rate)||void 0===n?void 0:n.length)>0&&!t.data.shop_rate.some(t=>t.uid===l.uid)?c("div",[l.mobile?c("span",[l._v("공급률")]):l._e(),l._v(" "+l._s(t.data.supply_rate)+"%\n        ")]):l._e()]),(null===(u=t.data.shop_rate)||void 0===u?void 0:u.length)>0&&t.data.shop_rate.some(t=>t.uid===l.uid)?c("div",{staticClass:"final-price"},l._l(t.data.shop_rate,(function(e){return c("span",{key:e.uid},[l.uid===e.uid?c("span",[l.mobile?c("span",[l._v("공급가")]):l._e(),l._v(" "+l._s((t.data.price*e.rate/100).toLocaleString())+" 원")]):l._e()])})),0):c("div",{staticClass:"final-price"},[l.mobile?c("span",[l._v("공급가")]):l._e(),l._v(" "+l._s((t.data.price*t.data.supply_rate/100).toLocaleString())+" 원\n      ")]),c("div",{staticClass:"count"},[l.mobile?c("span",[l._v("주문")]):l._e(),l._v(" "+l._s(t.data.count))]),c("div",{staticClass:"count"},[l.mobile?c("span",[l._v("공급")]):l._e(),c("span",{class:{warning:t.data.count!==t.data.reply_count&&0!==t.data.shop_order_status}},[l._v(l._s(null===t.data.reply_count?"-":t.data.reply_count))])])])})),0),null!==(null===(s=l.books[0])||void 0===s?void 0:s.data.memo)&&""!==(null===(i=l.books[0])||void 0===i?void 0:i.data.memo)&&0!==l.books.length?c("section",{staticClass:"memo"},[c("h4",[l._v("메모")]),c("div",[l._v(l._s(null===(o=l.books[0])||void 0===o?void 0:o.data.memo))])]):l._e(),l.skeletonLoading?l._e():c("section",{staticClass:"total-wrap mt24"},[c("div",[c("span",{staticClass:"total-prod"},[l._v("총 "),0===this.books[0].data.shop_order_status?c("span",[l._v(l._s(l.bookCount))]):l._e(),1===this.books[0].data.shop_order_status?c("span",[l._v(l._s(l.checkCount))]):l._e(),3===this.books[0].data.shop_order_status?c("span",[l._v(l._s(this.books[0].data.totalCount))]):l._e(),l._v("권")]),c("span",{staticClass:"total"},[l._v("합계 "),0===this.books[0].data.shop_order_status?c("span",[l._v(l._s(l.totalPrice.toLocaleString()))]):l._e(),1===this.books[0].data.shop_order_status?c("span",[l._v(l._s(l.checkPrice.toLocaleString()))]):l._e(),3===this.books[0].data.shop_order_status?c("span",[l._v(l._s(this.books[0].data.totalPrice.toLocaleString()))]):l._e(),l._v("원")])]),c("button",{staticClass:"primary",attrs:{disabled:1!==(null===(r=l.books[0])||void 0===r?void 0:r.data.shop_order_status)},on:{click:l.order}},[l._v("발주")])])],1)}),[function(){var t=this._self._c;return t("div",{staticClass:"d-flex"},[t("div",[this._v("정가")]),t("div",[this._v("공급률")])])}],!1,null,"41497fbd",null).exports},data(){return{id:this.$route.params.id,date:this.$route.params.date,publisher:this.$route.params.publisher,orderTimeId:this.$route.params.orderTimeId}}}),C=(s("aefe"),Object(m.a)(x,(function(){var t=this,e=t._self._c;return e("section",[e("h2",{staticClass:"sub-title"},[t._v("내역서 확인")]),e("section",{staticClass:"sub-container"},[e("article",{staticClass:"order-info d-flex justify-space-between"},[e("div",[t._v("\n        출판사명: "),e("strong",[t._v(t._s(t.publisher))])]),e("div",[t._v("주문일자 : "+t._s(t.date))])]),e("OrderResultList",{attrs:{id:t.id,orderTimeId:t.orderTimeId}})],1)])}),[],!1,null,"57a95d22",null));e.default=C.exports},aefe:function(t,e,s){"use strict";s("2edc")},b57b:function(t,e,s){"use strict";s("da01")},c2fe:function(t,e,s){},cc0a:function(t,e,s){"use strict";s("4809")},da01:function(t,e,s){},ee6b:function(t,e,s){"use strict";s("694a")},f412:function(t,e,s){"use strict";s("c2fe")},f53c:function(t,e,s){}}]);