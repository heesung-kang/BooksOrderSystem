(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-8fb51bce"],{"0c93":function(t,s,e){},"1f0b":function(t,s,e){"use strict";var a=e("3129"),i={name:"BookListMobileSkeleton"},o=(e("f412"),e("2877")),r=Object(o.a)(i,(function(){var t=this._self._c;return t("div",[t("ul",[t("li",[t("section",{staticClass:"skeleton-book-list"},[t("div",{staticClass:"img"},[t(a.a,{attrs:{type:"list-item-avatar-two-line"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}})],1)])]),t("li",[t("section",{staticClass:"skeleton-book-list"},[t("div",{staticClass:"img"},[t(a.a,{attrs:{type:"list-item-avatar-two-line"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}})],1)])]),t("li",[t("section",{staticClass:"skeleton-book-list"},[t("div",{staticClass:"img"},[t(a.a,{attrs:{type:"list-item-avatar-two-line"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}})],1)])]),t("li",[t("section",{staticClass:"skeleton-book-list"},[t("div",{staticClass:"img"},[t(a.a,{attrs:{type:"list-item-avatar-two-line"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}})],1)])]),t("li",[t("section",{staticClass:"skeleton-book-list"},[t("div",{staticClass:"img"},[t(a.a,{attrs:{type:"list-item-avatar-two-line"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}}),t(a.a,{attrs:{type:"text"}})],1)])])])])}),[],!1,null,"975c769e",null);s.a=r.exports},"2edc":function(t,s,e){},4809:function(t,s,e){},"68e0":function(t,s,e){"use strict";e.d(s,"a",(function(){return a}));const a=function(t,s,e,a){return{name:t,width:s,height:e,resizable:a,clickToClose:!1,draggable:".popup-title",scrollable:!0}}},"691b":function(t,s,e){"use strict";var a=e("3129"),i={name:"BookListSkeleton"},o=(e("b57b"),e("2877")),r=Object(o.a)(i,(function(){var t=this._self._c;return t("div",[t("ul",[t("li",[t("section",{staticClass:"d-flex align-center justify-space-between skeleton-book-list"},[t("div",{staticClass:"img"},[t(a.a,{attrs:{type:"list-item-avatar-two-line"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1)])]),t("li",[t("section",{staticClass:"d-flex align-center justify-space-between skeleton-book-list"},[t("div",{staticClass:"img"},[t(a.a,{attrs:{type:"list-item-avatar-two-line"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1)])]),t("li",[t("section",{staticClass:"d-flex align-center justify-space-between skeleton-book-list"},[t("div",{staticClass:"img"},[t(a.a,{attrs:{type:"list-item-avatar-two-line"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1)])]),t("li",[t("section",{staticClass:"d-flex align-center justify-space-between skeleton-book-list"},[t("div",{staticClass:"img"},[t(a.a,{attrs:{type:"list-item-avatar-two-line"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1)])]),t("li",[t("section",{staticClass:"d-flex align-center justify-space-between skeleton-book-list"},[t("div",{staticClass:"img"},[t(a.a,{attrs:{type:"list-item-avatar-two-line"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1),t("div",{staticClass:"text"},[t(a.a,{attrs:{type:"text"}})],1)])])])])}),[],!1,null,"d8eeb990",null);s.a=r.exports},7402:function(t,s,e){"use strict";var a=e("132d"),i={methods:{close(){this.$emit("close")}}},o=(e("cc0a"),e("2877")),r=Object(o.a)(i,(function(){var t=this._self._c;return t("div",{staticClass:"modal-wrap"},[t("div",{staticClass:"close",on:{click:this.close}},[t(a.a,[this._v("mdi-window-close")])],1),this._t("head"),t("div",{staticClass:"line"}),t("div",{staticClass:"body"},[this._t("body")],2),this._t("footer")],2)}),[],!1,null,"1c84da6b",null);s.a=r.exports},"74a0":function(t,s,e){"use strict";e("a970")},"84ac":function(t,s,e){"use strict";e.r(s);var a=e("ac7c"),i=(e("14d9"),e("2f62")),o=e("f3e4"),r=e("e71f"),c=e("e31c"),l=e("691b"),n=e("1f0b");e("b7ef");var d={data:()=>({nPay:{goods:"",ttl:20,price:""},qr:"",result:"",ti:"",re:"",res:{createdQrcode:!1,paid:!1},storeId:"n20fz-id19l-02n18-15o48-r59gl"}),methods:{_isIE(){var t=navigator.userAgent.toLowerCase();return-1!=t.indexOf("msie")&&parseInt(t.split("msie")[1])},_open(t){this._isIE()&&this._isIE()<10?alert("internet explorer 10 이상 지원합니다."):void 0===this.qr||this.nPay.goods!==t.productName||this.nPay.price!==t.productAmount||this.nPay.ttl!==t.ttl?(this.nPay.goods=t.productName,this.nPay.price=t.productAmount,this.nPay.ttl=t.ttl,this._createQrcode()):this._createWait()},_createQrcode(){var t="https://api.instapay.kr/s2/sell?"+("goods="+encodeURIComponent(btoa(unescape(encodeURIComponent(this.nPay.goods))))+"&price="+this.nPay.price+"&ttl="+this.nPay.ttl+"&ldate=nil"),s=new XMLHttpRequest;const e=this;s.onreadystatechange=function(){4==this.readyState&&200==this.status&&e._resultQrcode(this.responseText)},s.open("get",t,!0),s.setRequestHeader("authorization","Bearer "+this.storeId),s.send()},_resultQrcode(t){var s=JSON.parse(t);"ok"===s.result?this._create(s.gid):this.result=this.res},_create(t){var s="https://api.instapay.kr/s2/buy?i="+t,e=new XMLHttpRequest;const a=this;e.onreadystatechange=function(){4==this.readyState&&200==this.status&&a._result(this.responseText)},e.open("get",s,!0),e.setRequestHeader("authorization","Bearer "+this.storeId),e.send()},_result(t){var s=JSON.parse(t);"ok"===s.result?(this.qr=s.qr,this.ti=s.ti,this.re=s.re,this.res.createdQrcode=!0,this._createWait()):this.result=this.res},_createWait(){var t="https://api.instapay.kr/s2/wait?ti="+this.ti,s=new XMLHttpRequest;const e=this;s.onreadystatechange=function(){4==this.readyState&&200==this.status&&e._resultWait(this.responseText)},s.open("get",t,!0),s.send()},_resultWait(t){var s=JSON.parse(t);"ok"===s.result?"entry"===s.tstatus?(alert("결제가 진행중 입니다. 창을 닫거나, 새로고침 하시면 오류가 발생할 수 있습니다."),this._waitComplete()):(this.res.paid=!0,this.result=this.res):this.result=this.res},_waitComplete(){var t="https://api.instapay.kr/s2/wait?ti="+this.ti+"&st=complete",s=new XMLHttpRequest;const e=this;s.onreadystatechange=function(){4==this.readyState&&200==this.status&&e._resultWait(this.responseText)},s.open("get",t,!0),s.send()}}},p={name:"Order",components:{modalWrap:e("7402").a},mixins:[d],props:["book","price"],watch:{"res.paid":function(t){t&&(this.$attrs.update(),this.$emit("close"))}},mounted(){this._open({productName:this.book.join(","),productAmount:this.price,ttl:60})},methods:{close(){this.$emit("close")}}},u=(e("74a0"),e("2877")),h=Object(u.a)(p,(function(){var t=this,s=t._self._c;return s("modalWrap",{on:{close:t.close}},[s("template",{slot:"head"},[s("h2",[t._v("발주(결제)")])]),s("template",{slot:"body"},[s("section",{staticClass:"info"},[s("h3",[t._v("\n        "+t._s(t.book[0])+" "),t.book.length>1?s("span",[t._v("외 "+t._s(t.book.length-1)+"권")]):t._e()]),s("p",{staticClass:"price"},[t._v(t._s(t.price.toLocaleString())+"원")]),s("div",{staticClass:"qr-wrap"},[s("div",{staticClass:"center"},[s("img",{attrs:{src:t.qr,alt:""}})]),s("div",{staticClass:"pay"},[t._v("인스타페이 앱으로 결제해 주세요")])])])])],2)}),[],!1,null,"844c0650",null).exports,_=e("68e0"),v={components:{BookListMobileSkeleton:n.a,BookListSkeleton:l.a},mixins:[d],props:["id","orderTimeId"],data:()=>({books:[],selected:[],checkCount:0,checkPrice:0,buyList:[],buyId:[]}),computed:{...Object(i.b)("common",["windowWidth","mobile","skeletonLoading"]),bookCount(){if(0===this.books[0].data.shop_order_status){let t=0;return this.books.forEach(s=>t+=Number(s.data.count)),t}return 0},totalPrice(){let t=0;return this.books.forEach(s=>{t+=s.data.price*s.data.supply_rate*s.data.reply_count/100}),t}},watch:{selected(){1===this.books[0].data.shop_order_status&&(this.checkCount=0,this.checkPrice=0,this.books.forEach(t=>{this.selected.includes(t.id)&&(this.checkCount+=t.data.reply_count,this.checkPrice+=t.data.price*t.data.supply_rate*t.data.reply_count/100)}))}},created(){this.load()},methods:{async load(){try{this.books=[],this.$store.commit("common/setSkeleton",!0);const{uid:t}=Object(o.b)("userInfo"),s=Object(r.j)(Object(r.b)(c.b,"orderRequest"),Object(r.o)("uid","==",t),Object(r.o)("sid","==",Number(this.id)),Object(r.o)("order_time_id","==",this.orderTimeId));(await Object(r.f)(s)).forEach(t=>{this.books.push({id:t.id,data:t.data()})})}catch(t){console.log(t)}this.$store.commit("common/setSkeleton",!1)},async order(){0!==this.checkCount?(this.buyList=[],this.buyId=[],this.books.forEach(t=>{this.selected.includes(t.id)&&(this.buyList.push(t.data.subject),this.buyId.push(t.id))}),this.mobile?this.$modal.show(h,{book:this.buyList,price:this.checkPrice,update:this.paidComplete},Object(_.a)("ModalOrder","95%","auto",!1)):this.$modal.show(h,{book:this.buyList,price:this.checkPrice,update:this.paidComplete},Object(_.a)("ModalOrder","500px","auto",!1))):alert("책을 선택해 주세요")},async paidComplete(){const t=Object(r.p)(c.b);try{const s=Object(r.k)();await this.books.forEach(e=>{const a=Object(r.d)(c.b,"orderRequest",e.id);t.update(a,{shop_order_status:3,order_real_time_id:this.$date().format("YYYYMMDDHHmmss"),order_real_time:s,totalPrice:this.checkPrice,totalCount:this.checkCount})}),await this.buyId.forEach(s=>{const e=Object(r.d)(c.b,"orderRequest",s);t.update(e,{order_check:!0})}),await t.commit(),await this.load()}catch(t){console.log(t)}}}},b=(e("c889"),{name:"OrderResult",components:{OrderResultList:Object(u.a)(v,(function(){var t,s,e,i,o=this,r=o._self._c;return r("section",[!o.mobile&&o.skeletonLoading?r("BookListSkeleton"):o._e(),o.mobile&&o.skeletonLoading?r("BookListMobileSkeleton"):o._e(),o.mobile||o.skeletonLoading?o._e():r("section",{staticClass:"header d-flex"},[o._m(0),r("div",[o._v("ISBN")]),o._m(1),r("div",[o._v("공급가")]),r("div",[o._v("주문")]),r("div",[o._v("공급")])]),r("ul",{staticClass:"body"},o._l(o.books,(function(t,s){var e,i,c;return r("li",{key:s,staticClass:"d-flex align-center",class:{none:t.data.shop_order_status>2&&!1===t.data.order_check}},[r("div",{staticClass:"d-flex align-center info-wrap ck-wrap"},[r("div",{staticClass:"ck-box"},[3===(null===(e=o.books[0])||void 0===e?void 0:e.data.shop_order_status)?r(a.a,{attrs:{"input-value":t.data.order_check,disabled:""}}):r(a.a,{attrs:{value:t.id,disabled:1!==(null===(i=o.books[0])||void 0===i?void 0:i.data.shop_order_status)||0===t.data.reply_count},model:{value:o.selected,callback:function(t){o.selected=t},expression:"selected"}})],1),r("div",{staticClass:"book-info"},[r("h3",[o._v(o._s(t.data.subject))]),r("div",{staticClass:"author"},[o._v(o._s(t.data.author))])])]),r("div",{staticClass:"isbn"},[o._v(o._s(t.data.isbn))]),r("div",{staticClass:"d-flex price-info"},[r("div",{staticClass:"normal-price"},[o.mobile?r("span",[o._v("정가")]):o._e(),o._v(" "+o._s(null===(c=t.data.price)||void 0===c?void 0:c.toLocaleString()))]),r("div",[o.mobile?r("span",[o._v("공급률")]):o._e(),o._v(" "+o._s(t.data.supply_rate)+"%")])]),r("div",{staticClass:"final-price"},[o.mobile?r("span",[o._v("공급가")]):o._e(),o._v(" "+o._s((t.data.price*t.data.supply_rate/100).toLocaleString())+" 원")]),r("div",{staticClass:"count"},[o.mobile?r("span",[o._v("주문")]):o._e(),o._v(" "+o._s(t.data.count))]),r("div",{staticClass:"count"},[o.mobile?r("span",[o._v("공급")]):o._e(),r("span",{class:{warning:t.data.count!==t.data.reply_count&&0!==t.data.shop_order_status}},[o._v(o._s(null===t.data.reply_count?"-":t.data.reply_count))])])])})),0),null!==(null===(t=o.books[0])||void 0===t?void 0:t.data.memo)&&""!==(null===(s=o.books[0])||void 0===s?void 0:s.data.memo)&&0!==o.books.length?r("section",{staticClass:"memo"},[r("h4",[o._v("메모")]),r("div",[o._v(o._s(null===(e=o.books[0])||void 0===e?void 0:e.data.memo))])]):o._e(),o.skeletonLoading?o._e():r("section",{staticClass:"total-wrap mt24"},[r("div",[r("span",{staticClass:"total-prod"},[o._v("총 "),0===this.books[0].data.shop_order_status?r("span",[o._v(o._s(o.bookCount))]):o._e(),1===this.books[0].data.shop_order_status?r("span",[o._v(o._s(o.checkCount))]):o._e(),3===this.books[0].data.shop_order_status?r("span",[o._v(o._s(this.books[0].data.totalCount))]):o._e(),o._v("권")]),r("span",{staticClass:"total"},[o._v("합계 "),0===this.books[0].data.shop_order_status?r("span",[o._v(o._s(o.totalPrice.toLocaleString()))]):o._e(),1===this.books[0].data.shop_order_status?r("span",[o._v(o._s(o.checkPrice.toLocaleString()))]):o._e(),3===this.books[0].data.shop_order_status?r("span",[o._v(o._s(this.books[0].data.totalPrice.toLocaleString()))]):o._e(),o._v("원")])]),r("button",{staticClass:"primary",attrs:{disabled:1!==(null===(i=o.books[0])||void 0===i?void 0:i.data.shop_order_status)},on:{click:o.order}},[o._v("발주")])])],1)}),[function(){var t=this._self._c;return t("div",{staticClass:"d-flex dual"},[t("div",[this._v("발주")]),t("div",[this._v("품목정보")])])},function(){var t=this._self._c;return t("div",{staticClass:"d-flex"},[t("div",[this._v("정가")]),t("div",[this._v("공급률")])])}],!1,null,"774c37b3",null).exports},data(){return{id:this.$route.params.id,date:this.$route.params.date,publisher:this.$route.params.publisher,orderTimeId:this.$route.params.orderTimeId}}}),y=(e("aefe"),Object(u.a)(b,(function(){var t=this,s=t._self._c;return s("section",[s("h2",{staticClass:"sub-title"},[t._v("내역서 확인")]),s("section",{staticClass:"sub-container"},[s("article",{staticClass:"order-info d-flex justify-space-between"},[s("div",[t._v("\n        출판사명: "),s("strong",[t._v(t._s(t.publisher))])]),s("div",[t._v("주문일자 : "+t._s(t.date))])]),s("OrderResultList",{attrs:{id:t.id,orderTimeId:t.orderTimeId}})],1)])}),[],!1,null,"57a95d22",null));s.default=y.exports},a970:function(t,s,e){},aefe:function(t,s,e){"use strict";e("2edc")},b57b:function(t,s,e){"use strict";e("da01")},c2fe:function(t,s,e){},c889:function(t,s,e){"use strict";e("0c93")},cc0a:function(t,s,e){"use strict";e("4809")},da01:function(t,s,e){},f412:function(t,s,e){"use strict";e("c2fe")}}]);