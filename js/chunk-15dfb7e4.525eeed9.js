(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-15dfb7e4"],{2698:function(t,s,e){},"277f":function(t,s,e){"use strict";e.r(s);e("14d9");var a=e("2f62"),i=e("e31c"),o=e("e71f"),c=e("f3e4"),n=e("78dc"),r={name:"BookList",components:{Toast:n.a},props:["books","infoChange","shopRate","basicRate","bookRate","totalPage","page"],data:()=>({cart:[],message:"",status:!1,listWidth:0,titleMaxWidth:0,withBtn:!0}),computed:{...Object(a.b)("common",["cartList","mobile"])},watch:{books(t){t.length>0&&this.setSize()}},async created(){try{const t=Object(c.b)("userInfo");this.uid=t.uid;const s=Object(o.k)(Object(o.b)(i.b,"cart-"+this.uid));(await Object(o.g)(s)).forEach(t=>{this.cart.push(t.data())})}catch(t){console.error("Error adding document: ",t)}},mounted(){window.onresize=()=>{this.setSize()}},methods:{async addCart(t){try{this.cart.some(s=>s.isbn===t.isbn)?(this.status=!this.status,this.message="이미 담아 두었습니다.<br/>‘장바구니’에서 수량을 조절해 주세요"):(this.$store.commit("common/setLoading",!0),t.count=1,await Object(o.a)(Object(o.b)(i.b,"cart-"+this.uid),t),this.cart.push(t),this.status=!this.status,this.message="장바구니에 상품이 추가되었습니다.",this.$store.commit("common/changeCartList",this.cartList+1))}catch(t){console.error("Error adding document: ",t)}this.$store.commit("common/setLoading",!1)},setSize(){this.mobile?(this.listWidth=document.querySelector(".book-list").clientWidth,this.titleMaxWidth=this.listWidth-100,setTimeout(()=>{document.querySelectorAll(".book-subject").forEach(t=>{t.style.maxWidth=this.titleMaxWidth+"px"})},500)):(this.listWidth=document.querySelector(".book-list").clientWidth,this.titleMaxWidth=this.listWidth-400,setTimeout(()=>{document.querySelectorAll(".book-subject").forEach(t=>{t.style.maxWidth=this.titleMaxWidth+"px"})},500))}}},l=(e("def3"),e("2877")),d=Object(l.a)(r,(function(){var t=this,s=t._self._c;return s("div",[s("section",{staticClass:"book-list"},[t.books.length>0?s("ul",t._l(t.books,(function(e){return s("li",{key:e.data.isbn},[s("section",{staticClass:"contents d-flex align-center justify-space-between"},[s("article",{staticClass:"basic-info d-flex align-center"},[s("section",{staticClass:"thumbnail"},[s("img",{attrs:{src:`https://bookthumb-phinf.pstatic.net/cover/${e.data.image}?type=m1`,alt:e.data.subject}})]),s("div",{staticClass:"book-info"},[s("h3",{staticClass:"book-subject"},[t._v(t._s(e.data.subject))]),s("div",{staticClass:"author"},[t._v(t._s(e.data.author))]),s("div",{staticClass:"pub-isbn"},[s("span",{staticClass:"mr15"},[t._v(t._s(e.data.publisher)+"("+t._s(e.data.publication_date)+")")]),s("span",[t._v(t._s(e.data.isbn))])])])]),s("article",{staticClass:"price-info"},[s("div",{staticClass:"mr14"},[t._v("정가 "+t._s(e.data.price&&e.data.price.toLocaleString())+"원")]),t.bookRate.some(t=>t.data.isbn===e.data.isbn&&""!==t.data.rate)?s("div",t._l(t.bookRate,(function(a,i){return s("div",{key:i,staticClass:"mr10"},[a.data.isbn===e.data.isbn?s("span",[t._v("공급률 "+t._s(a.data.rate)+"%")]):t._e()])})),0):t._e(),!t.bookRate.some(t=>t.data.isbn===e.data.isbn&&""!==t.data.rate)&&t.shopRate.some(t=>t.sid===e.data.sid&&""!==t.rate)?s("div",t._l(t.shopRate,(function(a,i){return s("div",{key:i,staticClass:"mr10"},[a.sid===e.data.sid&&""!==a.rate?s("span",[t._v(" 공급률 "+t._s(a.rate)+"% ")]):t._e()])})),0):t._e(),t.bookRate.some(t=>t.data.isbn===e.data.isbn&&""!==t.data.rate)||t.shopRate.some(t=>t.sid===e.data.sid&&""!==t.rate)?t._e():s("div",t._l(t.basicRate,(function(a,i){return s("div",{key:i,staticClass:"mr10"},[e.data.sid===a.sid?s("span",[t._v("공급률 "+t._s(a.supplyRate)+"%")]):t._e()])})),0),t.bookRate.some(t=>t.data.isbn===e.data.isbn&&""!==t.data.rate)?s("div",{staticClass:"price"},t._l(t.bookRate,(function(a,i){return s("div",{key:i},[a.data.isbn===e.data.isbn?s("span",{staticClass:"supply-price"},[t._v(" 공급가 "+t._s(e.data.price&&(e.data.price*a.data.rate/100).toLocaleString())+"원 ")]):t._e()])})),0):t._e(),!t.bookRate.some(t=>t.data.isbn===e.data.isbn&&""!==t.data.rate)&&t.shopRate.some(t=>t.sid===e.data.sid&&""!==t.rate)?s("div",{staticClass:"price"},t._l(t.shopRate,(function(a,i){return s("div",{key:i},[a.sid===e.data.sid&&""!==a.rate?s("span",{staticClass:"supply-price"},[t._v(" 공급가 "+t._s(e.data.price&&(e.data.price*a.rate/100).toLocaleString())+"원 ")]):t._e()])})),0):t._e(),t.bookRate.some(t=>t.data.isbn===e.data.isbn&&""!==t.data.rate)||t.shopRate.some(t=>t.sid===e.data.sid&&""!==t.rate)?t._e():s("div",{staticClass:"price"},t._l(t.basicRate,(function(a,i){return s("div",{key:i,staticClass:"mr10"},[e.data.sid===a.sid?s("span",{staticClass:"supply-price"},[t._v("공급가 "+t._s(e.data.price&&(e.data.price*a.supplyRate/100).toLocaleString())+"원")]):t._e()])})),0)]),s("article",{staticClass:"add-cart"},[s("button",{staticClass:"basic",on:{click:function(s){return t.addCart(e.data)}}},[t._v("담기")])])])])})),0):s("div",{staticClass:"book-search-alert"},[t.infoChange?s("span",[t._v("검색 결과가 없습니다.")]):t._e()])]),t.books.length>=10&&t.totalPage!==t.page?s("div",{staticClass:"btn-more",on:{click:function(s){return t.$emit("more")}}},[s("button",{staticClass:"basic"},[t._v("더 보기")])]):t._e(),s("Toast",{attrs:{status:t.status,message:t.message,withBtn:t.withBtn}})],1)}),[],!1,null,"2a6da130",null).exports,h={components:{Selects:e("a05a").a,Toast:n.a},props:["itemList"],data:()=>({select:"",keyword:"",message:"",status:!1}),computed:{...Object(a.b)("common",["skeletonLoading"])},methods:{change(t){this.select=t},search(){if(""===this.keyword)return this.status=!this.status,void(this.message="검색어를 입력해주세요.");this.$emit("search",{select:this.select,keyword:this.keyword})}}},b=(e("c91a"),Object(l.a)(h,(function(){var t=this,s=t._self._c;return s("section",{staticClass:"search-group"},[s("Selects",{attrs:{itemList:t.itemList},on:{change:t.change}}),s("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],staticClass:"basic",attrs:{type:"text"},domProps:{value:t.keyword},on:{keypress:function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"enter",13,s.key,"Enter")?null:t.search.apply(null,arguments)},input:function(s){s.target.composing||(t.keyword=s.target.value)}}}),s("button",{staticClass:"basic",attrs:{disabled:t.skeletonLoading},on:{click:t.search}},[t._v("검색")]),s("Toast",{attrs:{status:t.status,message:t.message}})],1)}),[],!1,null,"2dd78b84",null).exports),u=e("bc3a");var m={name:"KakaoBookSearch",props:["keyword","search","clear"],data:()=>({list:[]}),watch:{search(){this.searchBooks()},clear(){this.list=[]}},methods:{async searchBooks(){this.$store.commit("common/setLoading",!0);const t=await(s={query:this.keyword},u.a.get("https://dapi.kakao.com/v3/search/book",{headers:{Authorization:"KakaoAK 2747cc77d6c23300d9fb150e23b1b9df"},params:s}).then(t=>t).catch(t=>console.log(t)));var s;this.$store.commit("common/setLoading",!1),200===t.status?(this.list=[],this.list=t.data.documents,this.list.forEach(t=>{const s=t.isbn.split(" ");t.isbn=s[1]}),0===t.data.documents.length&&this.$emit("result",!1)):this.$emit("result",!1)},isbn(t){this.$emit("result",t)}}},k=(e("7f24"),Object(l.a)(m,(function(){var t=this,s=t._self._c;return s("div",[t.list.length>0?s("ul",t._l(t.list,(function(e){return s("li",{key:e.isbn,on:{click:function(s){return t.isbn(e.isbn)}}},[t._v(t._s(e.title)+" : "+t._s(e.isbn))])})),0):t._e()])}),[],!1,null,"45624eeb",null).exports),p=e("691b"),f=e("1f0b"),g={components:{Toast:n.a,BookListMobileSkeleton:f.a,BookListSkeleton:p.a,SearchBasicGroup:b,BookList:d,KakaoBookSearch:k},data:()=>({itemList:[{item:"ISBN",value:"isbn"},{item:"책 제목",value:"subject"},{item:"저자",value:"author"},{item:"출판사",value:"publisher"}],select:"isbn",keyword:"",limit:10,books:[],lastVisible:"",infoChange:!1,kakaoSearch:!1,clear:!1,uid:"",shopRate:[],basicRate:[],bookRate:[],totalPage:0,page:1,message:"",status:!1}),computed:{...Object(a.b)("common",["loading","skeletonLoading","mobile"])},async mounted(){const t=Object(c.b)("userInfo");this.uid=t.uid;try{const t=Object(o.d)(i.b,"shopInfo",this.uid),s=await Object(o.f)(t);this.shopRate=s.data().shopRate,this.bookRate=s.data().bookRate}catch(t){console.log(t)}try{const t=Object(o.k)(Object(o.b)(i.b,"publisherInfo"));(await Object(o.g)(t)).forEach(t=>{this.basicRate.push({sid:t.data().sid,supplyRate:t.data().supplyRate})})}catch(t){console.error("Error adding document: ",t)}},methods:{async firstBookList(){this.$store.commit("common/setLoading",!0);const t=Object(o.k)(Object(o.b)(i.b,"booksData"),Object(o.p)(this.select,"==",this.keyword)),s=await Object(o.e)(t);this.$store.commit("common/setLoading",!1);const e=s.data().count;this.totalPage=Math.ceil(e/this.limit);try{this.$store.commit("common/setSkeleton",!0);const t=Object(o.k)(Object(o.b)(i.b,"booksData"),Object(o.p)(this.select,"==",this.keyword),Object(o.i)(this.limit)),s=await Object(o.g)(t);this.lastVisible=s.docs[s.docs.length-1],s.forEach(t=>{this.books.push({id:t.id,data:t.data()})}),this.infoChange=!0,this.$store.commit("common/setSkeleton",!1)}catch(t){console.error("Error adding document: ",t),this.$store.commit("common/setSkeleton",!1)}},async more(){this.page+=1;try{this.$store.commit("common/setLoading",!0);const t=Object(o.k)(Object(o.b)(i.b,"booksData"),Object(o.p)(this.select,"==",this.keyword),Object(o.n)(this.lastVisible),Object(o.i)(this.limit)),s=await Object(o.g)(t);0===s.docs.length&&(this.status=!this.status,this.message="도서정보가 더이상 없습니다."),this.lastVisible=s.docs[s.docs.length-1],s.forEach(t=>{this.books.push({id:t.id,data:t.data()})})}catch(t){console.error("Error adding document: ",t)}this.$store.commit("common/setLoading",!1)},search(t){this.books=[],"subject"!==t.select?(this.clear=!this.clear,""!==t.select&&(this.select=t.select),""!==t.keyword&&(this.keyword=t.keyword),this.firstBookList()):(this.infoChange=!1,this.keyword=t.keyword,this.kakaoSearch=!this.kakaoSearch)},isbnSearch(t){!1!==t?(this.books=[],this.select="isbn",this.keyword=t,this.firstBookList()):this.infoChange=!0}}},_=Object(l.a)(g,(function(){var t=this,s=t._self._c;return s("section",[s("h2",{staticClass:"sub-title"},[t._v("책 검색")]),s("section",{staticClass:"sub-container"},[s("SearchBasicGroup",{attrs:{itemList:t.itemList},on:{search:t.search}}),s("KakaoBookSearch",{attrs:{keyword:t.keyword,search:t.kakaoSearch,clear:t.clear},on:{result:t.isbnSearch}}),t.skeletonLoading&&!t.mobile?s("BookListSkeleton",{staticClass:"mt14"}):t._e(),t.skeletonLoading&&t.mobile?s("BookListMobileSkeleton",{staticClass:"mt14"}):s("BookList",{attrs:{books:t.books,infoChange:t.infoChange,shopRate:t.shopRate,basicRate:t.basicRate,bookRate:t.bookRate,totalPage:t.totalPage,page:t.page},on:{more:t.more}})],1),s("Toast",{attrs:{status:t.status,message:t.message}})],1)}),[],!1,null,null,null);s.default=_.exports},"37c5":function(t,s,e){},"3a65":function(t,s,e){},5281:function(t,s,e){},"7f24":function(t,s,e){"use strict";e("5281")},a05a:function(t,s,e){"use strict";var a=e("b974"),i={props:["itemList"],data:()=>({select:""}),mounted(){this.select=this.itemList[0].value}},o=(e("df9f"),e("2877")),c=Object(o.a)(i,(function(){var t=this,s=t._self._c;return s("div",{staticClass:"selects"},[s(a.a,{attrs:{dense:"",items:t.itemList,"item-text":"item","item-value":"value",outlined:""},on:{input:function(s){return t.$emit("change",t.select)}},model:{value:t.select,callback:function(s){t.select=s},expression:"select"}})],1)}),[],!1,null,"7b5afd12",null);s.a=c.exports},c91a:function(t,s,e){"use strict";e("3a65")},def3:function(t,s,e){"use strict";e("37c5")},df9f:function(t,s,e){"use strict";e("2698")}}]);